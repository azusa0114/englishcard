<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å˜èªã‚«ãƒ¼ãƒ‰</title>
<style>
  html, body {
  height: 100%;
  margin: 0;
}
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #f0f0f0;
    display: flex;
    flex-direction: column;
    justify-content: center; /* æ¨ªä¸­å¤® */
    align-items: center;  /* æ¨ªä¸­å¤® */
    height: 100vh;          /* ç”»é¢é«˜ã•ã‚’ç¢ºä¿ */
    background: #f0f0f0;
  }
  
  #card-container {
    position: relative;
    display: block;
    width: 90%;
    height: 60%;
    align-items: center;       /* æ¨ªæ–¹å‘ã«ä¸­å¤®å¯„ã› */
    box-sizing: border-box; /* ä½™ç™½ã‚‚ã‚µã‚¤ã‚ºå†…ã«å«ã‚ã‚‹æŒ‡å®šï¼ˆã‚ã‚Œã°å®‰å¿ƒï¼‰ */
    margin: auto;
    perspective: 1000px;
  }
  
 .card {
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding-top: 10px;
  padding-bottom: 10px;
  position: relative;  
  height: 100%;
  max-height: 90vh;
  margin: 0 auto;
   
  border: 1px solid #ccc;
  border-radius: 12px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  background-color: #fff;
  box-sizing: border-box;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}

.card.flipped {
  transform: rotateY(180deg);
}

  .card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.6s;
  gap: 15px; /* é©å®œé–“éš”èª¿æ•´ */
}
  
.card-front, .card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  top: 0;
  left: 0;
  box-sizing: border-box;
}

.card-front > div:not(.top-left):not(.top-right) {
  z-index: 2;
  text-align: center;
}
.card-back {
  transform: rotateY(180deg); /* â† ã“ã“ã«ç§»ã™ */
  z-index: 1;
}

.card-back .pronunciation {
  display: none !important;
}
  
.card-back > div:not(.top-left):not(.top-right) {
  z-index: 0;
  margin: 0 auto;       /* ä¸­å¤®ã«å¯„ã›ã‚‹ï¼ˆ80%ã«ã—ã¦ã‚‚ä¸­å¤®å¯„ã›ã—ãªã„ã¨åã‚‹ï¼‰ */
  text-align: left;     /* ãƒ†ã‚­ã‚¹ãƒˆã‚’å·¦æƒãˆ */
  /* transform: rotateY(180deg); â† ã“ã‚Œã¯å‰Šé™¤ */
}
  
  /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ»ç”»åƒãƒœã‚¿ãƒ³ä½ç½® */
  .top-left {
    position: absolute;
    top: 10px;
    left: 10px;
  }
  .top-right {
    position: absolute;
    top: 10px;
    right: 10px;
  }

  /* ãƒ†ã‚­ã‚¹ãƒˆéƒ¨åˆ† */
  .word {
    font-weight: bold;
    font-size: 3em;
    margin-top: 100px;
    margin-bottom: 30px;
  }
  .phonetic {
    color: #555;
    margin-bottom: 6px;
  }
  .pronunciation audio {
    vertical-align: middle;
    width: 100px;
  }
  .example {
    margin-top: 50px;
    font-style: italic;
    color: #333;
  }

  .meaning {
  width: 80%;
  color: #555;
  margin-top: 100px;
  margin-bottom: 6px;
  }
  
  .synonymous {
  margin-top: 50px;
  font-style: italic;
  color: #333;
  }

  /* ã‚¹ãƒ¯ã‚¤ãƒ—ç”¨ãƒ’ãƒ³ãƒˆ */
  #swipe-hint {
    text-align: center;
    display: block;
    margin-top: 5px;
    color: #777;
    font-size: 0.9em;
  }
</style>
</head>
<body>

  <div id="card-container"></div>  <!-- ã“ã“ã«JSãŒã‚«ãƒ¼ãƒ‰å…¥ã‚Œã‚‹ -->
  <div id="swipe-hint">â† ã‚¹ãƒ¯ã‚¤ãƒ—ã§å‰ã¸ãƒ»æ¬¡ã¸ â†’</div>
  
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ2VWN6QtWFSjmqftBs9PLXPsE4lNQ5fhfJZ5uhQkxUIj0ICZsY6UAdU1pMqJ8vHD7mROyt3YJ8JkxF/pub?gid=0&single=true&output=csv';

let cardsData = [];
let currentIndex = 0;
let flipped = false;

// localStorageã§å­¦ç¿’æ¸ˆã¿ä¿å­˜ã‚’ç®¡ç†
const remembered = JSON.parse(localStorage.getItem('rememberedWords') || '{}');

function saveRemembered(word, state) {
  remembered[word] = state;
  localStorage.setItem('rememberedWords', JSON.stringify(remembered));
}

function createCard(item) {
  const card = document.createElement('div');
  card.className = 'card';

  // è¡¨ã¨è£
  const front = document.createElement('div');
  front.className = 'card-front';
  const back = document.createElement('div');
  back.className = 'card-back';

  // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼ˆå·¦ä¸Šï¼‰
  const checkboxFront = document.createElement('input');
  checkboxFront.type = 'checkbox';
  checkboxFront.className = 'top-left';
  checkboxFront.checked = remembered[item.word] || false;
  checkboxFront.title = 'å­¦ç¿’æ¸ˆã¿ã«ãƒã‚§ãƒƒã‚¯';

  const checkboxBack = checkboxFront.cloneNode();
  checkboxBack.className = 'top-left';

  checkboxFront.addEventListener('change', () => {
    checkboxBack.checked = checkboxFront.checked;
    saveRemembered(item.word, checkboxFront.checked);
  });
  checkboxBack.addEventListener('change', () => {
    checkboxFront.checked = checkboxBack.checked;
    saveRemembered(item.word, checkboxBack.checked);
  });

  // ç”»åƒãƒœã‚¿ãƒ³ï¼ˆå³ä¸Šï¼‰
  const imgBtnFront = document.createElement('button');
  imgBtnFront.className = 'top-right';
  imgBtnFront.textContent = 'check image';
  imgBtnFront.title = 'check image';
  imgBtnFront.style.cursor = 'pointer';

  const imgBtnBack = imgBtnFront.cloneNode(true);
  imgBtnBack.className = 'top-right';

  imgBtnFront.addEventListener('click', (e) => {
    e.stopPropagation();
    if(item.image) window.open(item.image, '_blank');
  });
  imgBtnBack.addEventListener('click', (e) => {
    e.stopPropagation();
    if(item.image) window.open(item.image, '_blank');
  });

  // frontå†…å®¹
  front.appendChild(checkboxFront);
  front.appendChild(imgBtnFront);

  const wordElem = document.createElement('div');
  wordElem.className = 'word';
  wordElem.textContent = item.word;
  front.appendChild(wordElem);

  const phoneticElem = document.createElement('div');
  phoneticElem.className = 'phonetic';
  phoneticElem.textContent = item.phonetic;
  front.appendChild(phoneticElem);

  // ç™ºéŸ³ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒªãƒ³ã‚¯
 if(item.pronunciation) {
  const audioDiv = document.createElement('div');
  audioDiv.className = 'pronunciation';

  const audio = document.createElement('audio');
  audio.controls = true;
  audio.src = item.pronunciation;

  audio.addEventListener('click', e => {
    e.stopPropagation();
  });

  audioDiv.appendChild(audio);
  front.appendChild(audioDiv);
}
  const exampleElem = document.createElement('div');
  exampleElem.className = 'example';
  exampleElem.textContent = item.example;
  front.appendChild(exampleElem);

  // backå†…å®¹
  back.appendChild(checkboxBack);
  back.appendChild(imgBtnBack);

  const meaningElem = document.createElement('div');
  meaningElem.textContent = item.meaning;
  back.appendChild(meaningElem);

  card.appendChild(front);
  card.appendChild(back);

  if(item.synonymous) {
  const synonymous = document.createElement('div');
  synonymous.className = 'synonymous';
  synonymous.textContent = `Synonyms: ${item.synonymous}`;
  back.appendChild(synonymous);
}

  // ã‚¿ãƒƒãƒ—ã§è¡¨è£åˆ‡ã‚Šæ›¿ãˆ
  card.addEventListener('click', () => {
    flipped = !flipped;
    if(flipped) {
      card.classList.add('flipped');
    } else {
      card.classList.remove('flipped');
    }
  });

  return card;
}

function showCard(index) {
  const container = document.getElementById('card-container');
  container.innerHTML = '';
  flipped = false;

  if(index < 0) index = cardsData.length - 1;
  if(index >= cardsData.length) index = 0;
  currentIndex = index;

  const card = createCard(cardsData[index]);
  container.appendChild(card);
}

// ã‚¹ãƒ¯ã‚¤ãƒ—å‡¦ç† (ã‚¹ãƒãƒ›å‘ã‘)
let startX = 0;
let endX = 0;

const container = document.getElementById('card-container');
container.addEventListener('touchstart', e => {
  startX = e.touches[0].clientX;
});
container.addEventListener('touchend', e => {
  endX = e.changedTouches[0].clientX;
  if(endX - startX > 50) {
  showCard(currentIndex - 1); // å³ã‚¹ãƒ¯ã‚¤ãƒ— â†’ å‰ã®ã‚«ãƒ¼ãƒ‰
} else if(startX - endX > 50) {
  showCard(currentIndex + 1); // å·¦ã‚¹ãƒ¯ã‚¤ãƒ— â†’ æ¬¡ã®ã‚«ãƒ¼ãƒ‰
}
});

// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰çŸ¢å°ã‚­ãƒ¼ã§ã‚‚æ“ä½œã§ãã‚‹ã‚ˆã†ã«
document.addEventListener('keydown', e => {
  if(e.key === 'ArrowRight') {
    showCard(currentIndex + 1);
  } else if(e.key === 'ArrowLeft') {
    showCard(currentIndex - 1);
  }
});

// CSVèª­ã¿è¾¼ã¿
Papa.parse(csvUrl, {
  download: true,
  header: true,
  complete: function(results) {
    cardsData = results.data.filter(row => row.word); // ç©ºè¡Œé™¤å¤–
    showCard(0); // æœ€åˆã®ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
  }
});
  Papa.parse(csvUrl, {
  download: true,
  header: true,
  complete: function(results) {
    cardsData = results.data;
    showCard(0); // æœ€åˆã®ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
  }
});
  document.addEventListener('keydown', e => {
  <!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å˜èªã‚«ãƒ¼ãƒ‰</title>
<style>
  html, body {
  height: 100%;
  margin: 0;
}
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #f0f0f0;
    display: flex;
    justify-content: center; /* æ¨ªä¸­å¤® */
    align-items: center;    /* ç¸¦ä¸­å¤® */
    height: 100vh;          /* ç”»é¢é«˜ã•ã‚’ç¢ºä¿ */
    background: #f0f0f0;
  }
  
  #card-container {
    position: relative;
    width: 400px;
    height: 220px;
    padding: 20px;
    box-sizing: border-box; /* ä½™ç™½ã‚‚ã‚µã‚¤ã‚ºå†…ã«å«ã‚ã‚‹æŒ‡å®šï¼ˆã‚ã‚Œã°å®‰å¿ƒï¼‰ */
    margin: auto;
    perspective: 1000px;
  }
 .card {
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding-top: 40px;
  padding-bottom: 20px;
  position: relative;
  height: 400px;
  max-height: 90vh;
  border: 1px solid #ccc;
  border-radius: 12px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  background-color: #fff;
  box-sizing: border-box;
  position: relative; /* â† è¿½åŠ ã§å®‰å…¨ */
  transform-style: preserve-3d;
  transition: transform 0.6s;
}

.card.flipped {
  transform: rotateY(180deg);
}

.card-front, .card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  top: 0;
  left: 0;
  box-sizing: border-box;
}

.card-front > div:not(.top-left):not(.top-right) {
  z-index: 2;
  padding-left: 40px;
  padding-top: 30px; /* è¿½åŠ ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ä¸‹ã«ä¸‹ã’ã‚‹ */
}

.card-back > div:not(.top-left):not(.top-right) {
  z-index: 0;
  transform: rotateY(180deg);
  padding-left: 40px;
  padding-top: 30px; /* è£é¢ã‚‚åŒã˜ã */
}
  
  /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ»ç”»åƒãƒœã‚¿ãƒ³ä½ç½® */
  .top-left {
    position: absolute;
    top: 10px;
    left: 10px;
  }
  .top-right {
    position: absolute;
    top: 10px;
    right: 10px;
  }

  /* ãƒ†ã‚­ã‚¹ãƒˆéƒ¨åˆ† */
  .word {
    font-weight: bold;
    font-size: 1.5em;
    margin-bottom: 8px;
  }
  .phonetic {
    color: #555;
    margin-bottom: 6px;
  }
  .pronunciation audio {
    vertical-align: middle;
    width: 100px;
  }
  .example {
    margin-top: 15px;
    font-style: italic;
    color: #333;
  }

  /* ã‚¹ãƒ¯ã‚¤ãƒ—ç”¨ãƒ’ãƒ³ãƒˆ */
  #swipe-hint {
    text-align: center;
    margin-top: 10px;
    color: #777;
    font-size: 0.9em;
  }
</style>
</head>
<body>

  <div id="card-container"></div>  <!-- ã“ã“ã«JSãŒã‚«ãƒ¼ãƒ‰å…¥ã‚Œã‚‹ -->
  <div id="swipe-hint">â† ã‚¹ãƒ¯ã‚¤ãƒ—ã§å‰ã¸ãƒ»æ¬¡ã¸ â†’</div>
  
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ2VWN6QtWFSjmqftBs9PLXPsE4lNQ5fhfJZ5uhQkxUIj0ICZsY6UAdU1pMqJ8vHD7mROyt3YJ8JkxF/pub?gid=0&single=true&output=csv';

let cardsData = [];
let currentIndex = 0;
let flipped = false;

// localStorageã§å­¦ç¿’æ¸ˆã¿ä¿å­˜ã‚’ç®¡ç†
const remembered = JSON.parse(localStorage.getItem('rememberedWords') || '{}');

function saveRemembered(word, state) {
  remembered[word] = state;
  localStorage.setItem('rememberedWords', JSON.stringify(remembered));
}

function createCard(item) {
  const card = document.createElement('div');
  card.className = 'card';

  // è¡¨ã¨è£
  const front = document.createElement('div');
  front.className = 'card-front';
  const back = document.createElement('div');
  back.className = 'card-back';

  // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼ˆå·¦ä¸Šï¼‰
  const checkboxFront = document.createElement('input');
  checkboxFront.type = 'checkbox';
  checkboxFront.className = 'top-left';
  checkboxFront.checked = remembered[item.word] || false;
  checkboxFront.title = 'å­¦ç¿’æ¸ˆã¿ã«ãƒã‚§ãƒƒã‚¯';

  const checkboxBack = checkboxFront.cloneNode();
  checkboxBack.className = 'top-left';

  checkboxFront.addEventListener('change', () => {
    checkboxBack.checked = checkboxFront.checked;
    saveRemembered(item.word, checkboxFront.checked);
  });
  checkboxBack.addEventListener('change', () => {
    checkboxFront.checked = checkboxBack.checked;
    saveRemembered(item.word, checkboxBack.checked);
  });

  // ç”»åƒãƒœã‚¿ãƒ³ï¼ˆå³ä¸Šï¼‰
  const imgBtnFront = document.createElement('button');
  imgBtnFront.className = 'top-right';
  imgBtnFront.textContent = 'check image';
  imgBtnFront.title = 'check image';
  imgBtnFront.style.cursor = 'pointer';

  const imgBtnBack = imgBtnFront.cloneNode(true);
  imgBtnBack.className = 'top-right';

  imgBtnFront.addEventListener('click', (e) => {
    e.stopPropagation();
    if(item.image) window.open(item.image, '_blank');
  });
  imgBtnBack.addEventListener('click', (e) => {
    e.stopPropagation();
    if(item.image) window.open(item.image, '_blank');
  });

  // frontå†…å®¹
  front.appendChild(checkboxFront);
  front.appendChild(imgBtnFront);

  const wordElem = document.createElement('div');
  wordElem.className = 'word';
  wordElem.textContent = item.word;
  front.appendChild(wordElem);

  const phoneticElem = document.createElement('div');
  phoneticElem.className = 'phonetic';
  phoneticElem.textContent = item.phonetic;
  front.appendChild(phoneticElem);

  // ç™ºéŸ³ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒªãƒ³ã‚¯
if(item.pronunciation) {
  const audioDiv = document.createElement('div');
  audioDiv.className = 'pronunciation';

  const audio = document.createElement('audio');
  audio.src = item.pronunciation;

  // çµµæ–‡å­—ã®å†ç”Ÿãƒœã‚¿ãƒ³
  const playEmoji = document.createElement('span');
  playEmoji.textContent = 'ğŸ”Š'; // â–¶ï¸ ã‚„ ğŸ”ˆ ã«å¤‰æ›´ã—ã¦ã‚‚OK
  playEmoji.style.cursor = 'pointer';
  playEmoji.style.fontSize = '24px';
  playEmoji.style.marginLeft = '5px';

  playEmoji.addEventListener('click', (e) => {
    e.stopPropagation();
    audio.play();
  });

  audioDiv.appendChild(playEmoji);
  audioDiv.appendChild(audio);
  front.appendChild(audioDiv);
}
  
  const exampleElem = document.createElement('div');
  exampleElem.className = 'example';
  exampleElem.textContent = item.example;
  front.appendChild(exampleElem);
  
// backå†…å®¹
back.appendChild(checkboxBack);
back.appendChild(imgBtnBack);

// æ„å‘³
const meaningElem = document.createElement('div');
meaningElem.className = 'meaning'; // â˜…è¿½åŠ 
meaningElem.textContent = item.meaning;
back.appendChild(meaningElem);

// åŒç¾©èªï¼ˆã‚ã‚Œã°ï¼‰
if(item.synonymous) {
  const synonymous = document.createElement('div');
  synonymous.className = 'synonymous'; // â˜…è¿½åŠ 
  synonymous.textContent = `[Synonyms] ${item.synonymous}`;
  back.appendChild(synonymous);
}

  card.appendChild(front);
  card.appendChild(back);

  // ã‚¿ãƒƒãƒ—ã§è¡¨è£åˆ‡ã‚Šæ›¿ãˆ
  card.addEventListener('click', () => {
    flipped = !flipped;
    if(flipped) {
      card.classList.add('flipped');
    } else {
      card.classList.remove('flipped');
    }
  });

  return card;
}

function showCard(index) {
  const container = document.getElementById('card-container');
  container.innerHTML = '';
  flipped = false;

  if(index < 0) index = cardsData.length - 1;
  if(index >= cardsData.length) index = 0;
  currentIndex = index;

  const card = createCard(cardsData[index]);
  container.appendChild(card);
}

// ã‚¹ãƒ¯ã‚¤ãƒ—å‡¦ç† (ã‚¹ãƒãƒ›å‘ã‘)
let startX = 0;
let endX = 0;

const container = document.getElementById('card-container');
container.addEventListener('touchstart', e => {
  startX = e.touches[0].clientX;
});
container.addEventListener('touchend', e => {
  endX = e.changedTouches[0].clientX;
  if(endX - startX > 50) {
  showCard(currentIndex - 1); // å³ã‚¹ãƒ¯ã‚¤ãƒ— â†’ å‰ã®ã‚«ãƒ¼ãƒ‰
} else if(startX - endX > 50) {
  showCard(currentIndex + 1); // å·¦ã‚¹ãƒ¯ã‚¤ãƒ— â†’ æ¬¡ã®ã‚«ãƒ¼ãƒ‰
}
});

// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰çŸ¢å°ã‚­ãƒ¼ã§ã‚‚æ“ä½œã§ãã‚‹ã‚ˆã†ã«
document.addEventListener('keydown', e => {
  if(e.key === 'ArrowRight') {
    showCard(currentIndex + 1);
  } else if(e.key === 'ArrowLeft') {
    showCard(currentIndex - 1);
  }
});

// CSVèª­ã¿è¾¼ã¿
Papa.parse(csvUrl, {
  download: true,
  header: true,
  complete: function(results) {
    cardsData = results.data.filter(row => row.word); // ç©ºè¡Œé™¤å¤–
    showCard(0); // æœ€åˆã®ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
  }
});
  document.addEventListener('keydown', e => {
  if (e.key === 'ArrowLeft') {
    showCard(currentIndex - 1);
  } else if (e.key === 'ArrowRight') {
    showCard(currentIndex + 1);
  } else if (e.key === ' ') {
    // ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ã§è¡¨è£åè»¢
    document.querySelector('.card').click();
  }
});
</script>

</body>
</html>
